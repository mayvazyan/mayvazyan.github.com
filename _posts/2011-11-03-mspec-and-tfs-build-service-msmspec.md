---
layout: post
title: MSpec and TFS Build Service (MSMSpec)
date: 2011-11-03 22:15
author: ayvazyan
comments: true
categories: [.NET, Continuous Integration, Open Source, TDD, BDD, etc.]
---
<p>If you are going to use MSpec in your next .NET project you could face the following issues:</p>  <ol>   <li>Visual Studio won’t be able to execute MSpec specifications. (MSpec has it’s own test engine) </li>    <li>TFS Build Service is able to run only MSTest. </li> </ol>  <p>I found several articles on that problem in search engine. The best solution I found was <a href="http://www.heartysoft.com/Introducing-MSMSpec">MSMSpec</a>. I’m very appreciate the work <a title="MSMSpec&#39;s author" href="http://www.codeplex.com/site/users/view/HeartattacK">HeartattacK</a> had done since it really helped me!</p>  <p>MSMSpec is a T4 template which creates MSTests based on your MSpec classes. So it provides us ability to run MSpec specs in Visual Studio and in TFS Build Service, calculate Code Coverage and Test Impact using MS tools.</p>  <p>Here’s my approach to get it working:</p>  <ol>   <li>I added MSMSpec.tt to the solution items. And added its as a link to each MSpec project. </li>    <li>I made TestExecutionHelper class internal. It was public initially, so if one MSpec project is referencing another, public TestExecutionHelper will result in a conflict. (since both assemblies are declaring the same class). MSMSpec author suggests another workaround but it doesn’t fit my need since I use shared MSMSpec.tt. </li>    <li>I added 108 to the suppress warnings list in all MSpec projects. (to suppress “<em>_Setup hides inherited member. Use the new keyword if hiding was intended</em>” warning) </li>    <li>Finally I fixed Cleanups execution order (Parent class Cleanup should be called after Child class Cleanup):</li> </ol>  <div style="border-bottom: #d0d0d0 1px solid; border-left: #d0d0d0 1px solid; background-color: #f0f0f0; font-family: monospace; color: #006; border-top: #d0d0d0 1px solid; border-right: #d0d0d0 1px solid" class="csharp">   <ol>     <li style="font: 130% &#39;Courier New&#39;, courier, monospace; color: #003030; vertical-align: top">       <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; font: 1em/1.2em monospace; background: none transparent scroll repeat 0% 0%; color: #000020; vertical-align: top; padding-top: 0px"><span style="font-style: italic; color: #008080">//var cleanupInfos = FilterByType&lt;Cleanup&gt;(fieldInfos);</span></div>     </li>      <li style="font: 130% &#39;Courier New&#39;, courier, monospace; color: #003030; vertical-align: top">       <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; font: 1em/1.2em monospace; background: none transparent scroll repeat 0% 0%; color: #000020; vertical-align: top; padding-top: 0px">var cleanupInfos <span style="color: #008000">=</span> FilterByType<span style="color: #008000">&lt;</span>Cleanup<span style="color: #008000">&gt;</span><span style="color: #008000">(</span>fieldInfos<span style="color: #008000">)</span><span style="color: #008000">.</span><span style="color: #0000ff">Reverse</span><span style="color: #008000">(</span><span style="color: #008000">)</span><span style="color: #008000">;</span></div>     </li>   </ol> </div>  <p>Thant’s it. Hope this helps someone!</p>
